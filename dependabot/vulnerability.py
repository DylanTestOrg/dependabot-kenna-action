import logging


from dependabot.metadata import CWE_SCORES, CRITICALITY


class Vulnerability(object):
    __IDENTIFIER__ = "{cwe} :: {path}"

    def __init__(
        self,
        name=None,
        id=None,
        package_name=None,
        package_range=None,
        cve=None,
        ghsa_id=None,
        creation=None,
        rating=None,
        url=None
    ):

        self.name = name
        self.url = url
        self.description = "Dependabot Security issue"
        self.id = id
        self.package_name = package_name
        self.package_range = package_range

        self.ghsa_id = ghsa_id
        self.cve = cve
        self.rating = rating

        self.creation = creation

    @property
    def identifier(self):
        return self.package_name + " " + self.package_range

    @property
    def criticality(self):
        rating = self.rating
        for name, score, level in CRITICALITY:
            if name.lower() == rating.lower():
                return (name, score)
        return ('Information', 0)

    def __str__(self):
        return "Vulnerability(" + self.name + ", " + self.identifier + ")"
